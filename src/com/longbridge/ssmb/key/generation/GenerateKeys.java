package com.longbridge.ssmb.key.generation;

import nfp.ssm.core.SSMLib;

import java.util.Scanner;


public class GenerateKeys {

    String publicKey = "";
    String privateKey = "";
    String request = "";

    SSMLib ssmlib = null;
    Scanner scanner = new Scanner(System.in);
    String input = "";

    public void start() {


      publicKey = Properties.getProperties().getProperty("public.key.path").replaceAll("\"", "");
      privateKey = Properties.getProperties().getProperty("private.key.path").replaceAll("\"", "");

       ssmlib =  new SSMLib(publicKey, privateKey);
        System.out.println("ssmlib initiated : " + ssmlib);

        displayOperations();
        input = scanner.nextLine();
        System.out.println("Text entered : " + input);
        condition(input);


//        String m = "Tobi is a good boy";
//        String m2 = "";
//       String message = "848C036244318616909D750103FF52D9C13E1A118735CCDF7D194E914FB8B62BA56928814E0F3CDECD5DFF43FAD92D22AB59A093BC3C68AAECA3E587C6F898EAA2E0E5C490877A94B53AE53358263A13589F1D5EA4E272341FC4CE0A8C8513D42C356E5231108E8D07AD80592AB48AA9D4A6431AF0D31EBF109D20F2CE7F572A265CB04FC92C09949817107F3A6EC9C0337F4218A0C29A781AEB4B2154604779A80C28165365F6DD6854695E63DA9E35D1573152B7AADD1ABA502C3D13CDDE8F2EAB9F98D7D4D06F6298C1461C25A11F0002CADC765E99F6D288CAAE13D548A5B3BD22935B5E0971F027275F270FC6821D3FDB231391B5336D3569EA15EA892568EED979A9CE4E48950EE76C45450E10991EC8F30D4488E541C099AA91F8F52F2A2891211B50F482FA205F969752E529A249EF6B7206DF7A857AE43E8893A028EF321D6759C5E825EBC90958475227E0DE73F79F2A41281CAC92732B943318E576E4C1E32D9DA698090B9482EB78CDA998020829F8AC95893441560C479EC534189C68E3;";
//       String decrptedText = "";
//
//       String request =
//               "<NESingleRequest>\n" +
//               "    <SessionID>999051210121133115347479167064</SessionID>\n" +
//               "    <DestinationInstitutionCode>000014</DestinationInstitutionCode>\n" +
//               "    <ChannelCode>1</ChannelCode>\n" +
//               "    <AccountNumber>1000308437</AccountNumber>\n" +
//               "</NESingleRequest>";
//
//
//       String request1 = "<![CDATA[<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
//               "         <NESingleRequest>\n" +
//               "         <SessionID>999051210118095910000027811744</SessionID>\n" +
//               "         <DestinationInstitutionCode>999068</DestinationInstitutionCode>\n" +
//               "         <ChannelCode>1</ChannelCode>\n" +
//               "         <AccountNumber>5002947313</AccountNumber>\n" +
//               "         </NESingleRequest>]]>";
//
//       String m3 ="85010C0398242843033D3BD70107FF47B2ACF5358EBA2DAB75873E37EBB37E9E83A340E38598A081AB4DAD14109AA515B67EFAE6CF4F15C1C7796439C5136831E6508853156F95C961CA3C972DB6D9C94DC0D4686C34A532928765FF533E6B766CC85566BC3FDF7FDE6E89BEAEE4F7780CD885C3B7B40C4F053B80F77FCD5EF42C0659F5D55A9957A5057D875F98A76DB6B2367374ACCDF5AC62A3692E9CA4C72CDE1E0B0D1A41B5C1182309BA94D485ADE66F592DC6E8175C471BCBFF460AC90A890209B7CDCF15E4C7DD10AF28BDDEB3DB72B360F855F733E79D99D9DABB2C70EAD1004F25036B2ABBDF2FDD69520898C4C97B2810AF4E76F7B5D930ECED913EC3CFBBBA284563C1090B2FA2171FC9C0691A70C6D4D6B340D794316B44A129E0E5E866DA7CEF49332556F751C7C6FADCAF05598314E0715F0D50B856288B72465F5660135EF54CDFB88021421EE87F28E3277511929EA111CC03EA45FC552B34DC07A0A393886ACD7181B638B6CA3C852E633A4F1B5078CB215A318CA013F74D110098BC14D6C18CD9C5AAB998EB819E1A0658CC17FF4E8B563E88FB81D4BB9BB935E7561EB0616E635814E72F4022A4D52CE65A0198D38354A3CB06ED1B76281D680DB22AA40162716C6FE919FCD888AF6FA96E5753A363FC1ECD9110DA8FA285411A3C679597360B1AF4B8E71135081E676B142EFEDF73A1066E16D303A66CCCBE8A51D46979ED27A298A6F5173F65326F73586BB0BC24F19C92A1F3E3BC276E8C801B622C5936DA2A9E7878762FC50AA79B4D69AE6519BA26;";
//        System.out.println("Raw Message1 : " + m);
//       m2 = ssmlib.encryptMessage(m3);
//        System.out.println("Raw Message2 : " + m2);
//      decrptedText = ssmlib.decryptFile(m2,"fbn_809");
//
//
//       System.out.println("Raw Message3 : " + decrptedText);
}

   public void generateKeys(){
       boolean generated = false;

       System.out.println("About Generating Keys.......");
       generated = ssmlib.generateKeyPair("FirstTrustDev","first_trust_dev_key23");
       System.out.println("Generated keys ?? : " + generated);

       displayOperations();
       input = scanner.nextLine();
       System.out.println("Text entered : " + input);
       condition(input);
   }


     public void encryptRequest(){
         System.out.println("About Encrpting Request .......\n"+
         "Enter text to encrypt");
         input = scanner.nextLine();
         System.out.println("Text entered : " + input);
         if (input != null || !input.isEmpty()){

//            String text = "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?><BalanceEnquiryRequest>\n" +
//                    "  <SessionID>999051210305180016016332904906</SessionID>\n" +
//                    "  <NameEnquiryRef>999051210305175946986562478806</NameEnquiryRef>\n" +
//                    "  <DestinationInstitutionCode>999057</DestinationInstitutionCode>\n" +
//                    "  <ChannelCode>1</ChannelCode>\n" +
//                    "  <BeneficiaryAccountName>ABDUL D MOHAMMEDL</BeneficiaryAccountName>\n" +
//                    "  <BeneficiaryAccountNumber>2005554348</BeneficiaryAccountNumber>\n" +
//                    "  <BeneficiaryBankVerificationNumber>8066380595</BeneficiaryBankVerificationNumber>\n" +
//                    "  <BeneficiaryKYCLevel>3</BeneficiaryKYCLevel>\n" +
//                    "  <OriginatorAccountName>ESSIEN IMELDA  ANTHONY</OriginatorAccountName>\n" +
//                    "  <OriginatorAccountNumber>1000327977</OriginatorAccountNumber>\n" +
//                    "  <OriginatorBankVerificationNumber>22296149427</OriginatorBankVerificationNumber>\n" +
//                    "  <OriginatorKYCLevel>3</OriginatorKYCLevel>\n" +
//                    "  <TransactionLocation>6.4300747,3.4110715</TransactionLocation>\n" +
//                    "  <Narration>test</Narration>\n" +
//                    "  <PaymentReference>MB2021210305175951639910998004</PaymentReference>\n" +
//                    "  <Amount>10.00</Amount>\n" +
//                    "</BalanceEnquiryRequest>";

             String text1 = "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?><AccountBlockRequest>\n" +
                     "  <SessionID>999051210305180016016332904906</SessionID>\n" +
                     "  <DestinationInstitutionCode>999057</DestinationInstitutionCode>\n" +
                     "  <ChannelCode>1</ChannelCode>\n" +
                     "  <TargetAccountName>ESSIEN IMELDA  ANTHONY</TargetAccountName>\n" +
                     "  <TargetBankVerificationNumber>22296149427</TargetBankVerificationNumber>\n" +
                     "  <TargetAccountNumber>1000327977 </TargetAccountNumber>\n" +
                     "</AccountBlockRequest>";

             String text2 = "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?><NESingleRequest>\n" +
                     "    <SessionID>99905121042012 1038666300209569</SessionID>\n" +
                     "    <DestinationInstitutionCode>999057</DestinationInstitutionCode>\n" +
                     "    <ChannelCode>1</ChannelCode>\n" +
                     "    <AccountNumber>2005554348</AccountNumber>\n" +
                     "</NESingleRequest>";

             String text ="<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n" +
                     "<FTSingleCreditRequest>\n" +
                     "    <SessionID>999051210331091044125341329814</SessionID>\n" +
                     "    <NameEnquiryRef>999051210331091038666300209569</NameEnquiryRef>\n" +
                     "    <DestinationInstitutionCode>999057</DestinationInstitutionCode>\n" +
                     "    <ChannelCode>1</ChannelCode>\n" +
                     "    <BeneficiaryAccountName>ABDUL D MOHAMMED</BeneficiaryAccountName>\n" +
                     "    <BeneficiaryAccountNumber>2005554348</BeneficiaryAccountNumber>\n" +
                     "    <BeneficiaryBankVerificationNumber>22247156245</BeneficiaryBankVerificationNumber>\n" +
                     "    <BeneficiaryKYCLevel>3</BeneficiaryKYCLevel>\n" +
                     "    <OriginatorAccountName>EZENWAFOR OGECHI CONFIDENCE</OriginatorAccountName>\n" +
                     "    <OriginatorAccountNumber>1000309049</OriginatorAccountNumber>\n" +
                     "    <OriginatorBankVerificationNumber></OriginatorBankVerificationNumber>\n" +
                     "    <OriginatorKYCLevel>2</OriginatorKYCLevel>\n" +
                     "    <TransactionLocation>0.0,0.0</TransactionLocation>\n" +
                     "    <Narration>Zenith Bank/ABDUL D MOHAMMED/test</Narration>\n" +
                     "    <PaymentReference>FBNMortgage/NIP/210331091044</PaymentReference>\n" +
                     "    <Amount>120.00</Amount>\n" +
                     "</FTSingleCreditRequest>";

             System.out.println("Text entered 2 : " + text2);
             request = ssmlib.encryptMessage(text);
             System.out.println("Encrypted Request : " + request);
         }else {
             System.out.println("No input supplied : " + input);
         }
         displayOperations();
         input = scanner.nextLine();
         System.out.println("Text entered : " + input);
         condition(input);

     }

     public void decryptRequest(){
         System.out.println("About Decrypting Request .......");
         String decryptedRequest = "";
        // String text = "848C031C9801508AD8AED0010400B1F305AE68FA6AEEEC8B235B5E32E6D93F3162094B04B87E07EC248E92D0729D5EEA8CF6722E1B795A3E50C9B9A856E918A1A22FB379A31740C953EB9EDD22D84BBFAE983EA08F04CCCD89E16507D3E86D343C45B670067632DA90C492F3A9774EC1D2916D26CAE37CADADFEF5AF01A68F7975A5D960CA8B454A42ADF0E49E6EC967894E588F96E51C8FFDA6CFBE6C37B8CE60AEA176173B47086B09FD774D67A0BD8CAC6E2DAE05350B816E66318A2CD4584412994F42646361254951E535A36AF1E4A9293537079B299DFC4681D59066EA4C67B53E2BC08661D536207DE0E8D9EDAA0C59A64A425E;";
      //   String text = "85010C033B07134426CB36640107FF453019A1E273AC32EA33AA1DA0074C4DE53C51287D483F6E267AF648837D2C8707E63667814DA19DD9331BD4A5CA5AD74D0A1D32F2AFBCB500EDD7E3F1E9BDB78A7CD1EE80EA2A19DDDD38F100D1C4BDFC70DD4363DE0F032A956E4F20C82626A9DB531D55D5AD1E3D4929318E2558DCCB519AA68019DBB0B8D2A5EC864B0BE882F6FA7307183456059A5B17A8AE96C7C8CDEF7D704BA81DA1FDA0A77D3A0994B172DD70F56E886B22F3B5A9AF5D0D0B194B2DCBF398E0FA323D207133DFD94AB8DCFD2A969D09E79503E6CB4D037251A3CFD5966ADA1C52098619EAB0E225ACB87B87FB359249251611C3F14DB08D1B42416AE9C0643ABC3B38C8A6729A6B21C9C037B71E00B1DAA8B264BA6A7CBF17056157E96A060250BEC509F9FF933EBBAD13DC7E769C8698A7FD73F0C0E88A437D3980B888856F10A16CE0369AE1C20A884DB7905732D1DBBADE9DD609C807419CE1D871DB7474BC965CB2E2AB0ADF1A42962EF8D3F7C81EAAC6A2C5D735E12804BF2BF3759902E1A822FDD2590C82978B1F7DA1585D425587DC17D9C681A0D17FDE7F528E53F5474836F643DD3B49B80C9D9A35EF4B0016ACFCAF5DD4151E94DD8DB8C21D8C035457629F4A4E9147814E61F4FA7D5FB15457F09DAA4F2C825725408FB116A84C09C28C6C881ADAEBC26514355559640210A3DF4D8C0299DA170033141EF66675E81861;";
       //  String text = "85010C0398242843033D3BD70107FE314FE891DE09FB26441267BA36EFA5C9B570D8FB99F710C158022D6BC5293366B9A284F41D7E4D21EDDDDC6108FA3C64A00321ED34C0C91B4F467F5E9900A91990D43A2C6C640B2764EF8131B07D33263ED2EBC58022E7DE1C58A94FF3042611036EE566A5653A23631487B674A82EEF05743A3C9642D6EE8B30B4AB8B3ACE02E14C4772F73C4D79A3AE5B52EF4C656C5C990C485AC80982F1BACC568A09185743CEC9C640444DC6265ADC6DA1621346A7C8C51C9ED29686822720384ECB5DD1C140737B5CE903E8A968D17DB5ADC5B70AC13253CE014E3ECB7B9D6AC16B5903422A4FB1EC011CE51E116B573CBE25B64231531BF232EAED5882A158E3B756C8C9C07DA2DE25429AD170BDDFA43E2144AA0B94FB5D381304F1A2049FEEF8354AB29A5EE3CFCEE38B002D716C6F159847ED70B869B56859CE7C58428C442A3D39F7EBE5609D54EB2D5D446A5019CDAE2415A08E6D452F9661B12C79434FECAB7D15874C2FEDB7F750A4183A5D44FD6FF8395D945845268125EBA75A96075263468DE54D91BF1E68B6F61ADA2524E374A6E3850B09BB8A9D84850CA996DE951695FAF8ACA828B7251B71A2FDF88C380CC19967D2D0EE1DBD51D2C0E0BE1FEE655C1E8604A6E119D19F26B1BADA27143E7113039D9D81EC7DC4A1F9563E78CB499C039F18B2D56C0E08C995D86E0F3804EFCDA06A82BBB128952AE317BA08F7A71DDD8CD0FAF91C74E3C095AD448E305040D0F8E76BA35BFECC58E764EE6A3613AFF804D9C2AA8C7FACC6610990DA0F8D0DFF013442C4F206F2E818F112888BF512;";
       //  String text = "848C032AC12190CA34B3F10103FF7094577B078182C62A8C1FFF67E475C25B6B78D24E14E6DDB132E09603C7DE59970FCB4D0038BBFDBEA1923FB7BCB3762C43F2B4856138B4554014F278784B17E7DEFE8A5ED8D3594C37E0555EDC55C93AAE887CD0562BCB43EC16BF261F44753606265494610630EF17BE57BE63E08AAEB9C3F723F38FE80EF703B9C0E50D65C9C08909018A429355D6DCAA0DF5DB912E70D11095D0C5AFBA2297E5F06B33A5B6E9C525E190F4761558CBD30E13C4AB9A0937327F0046586EF612FB6F2931B8F88A6111EEA50DE034681B2CC09F4391F8A7841E2B33010A3BE6B68C35F3DDB77F8E649D6001865C58D61C35E243DB529D7DF48817B4277A2AFC94CE4AACBF068321F81E22FE40CF1B46DBC8425094EBB31734774060E363C94119438ED42B293469C56302649A96F90254B56DA6D48BEF2B47D8E027A7E9F9BB526DA455538AE0F861091C045F1421E27B81BF8A31753351E06773799DE703887A38D429B22F240BE753B0DED7FE1A5618C8345E9D85743A25A6B3ED9AFEC096937A62D860D112E8AF45F490C8651AF428040B771C69AD2DE355278A91C4B9E90381EDE459093A27E3D16CE018D1F3CABE774FF4D31F2541C7C9E9072B00159A6352B7BE729A860BD1286B07DB1F9AB6CFC3;";
        // String text = "85010C0398242843033D3BD70107FC0C00B1F9BB585F63AF92D641BC47E95AED0C160103708C979D2CCF4AC6940D182F7FF501AD27C2C06E48C55CD5FBCFE10C83D85E9A8C183F3749237BB645C3794B7C6C877C455867D8FFBE3E9E0EF29656A3D7A38C87AA4D383F07511F6D1A571B7317D40E3BD2C8A6F847909FA0DE5D5667A0E09F90937FBBDD2E93D5C98F9137C294C2B347045C4F0A00FCCFC2E474334CD8D9881D91CC783529672388340FD9BA6AB6BE311171E6912382E38905C4A852432AF7E7DA07C574BC53A1D02CF5A229E448039E7E395308E0607C34EC7B7C0535DD8C7A60BD107CA6C9329C18CBA7391681E70CB83C5EAF8766A9611979310942A31178D053EE580647983DC942C9C02D2A76B4AD6EEA547D309F71E0A80F508571E7F786EB83932791DACCFD6265BC264E9CA174B37ED43DE27F382C04468D5ADA676251004DCF3C5DB4BC0A1CEA3E558F10C1A81F3F6248CC35BC2AE804D8C03F62D8DB31E6424DCC3C04732A7C847977962F28348F386EF5FB18A782A0A59E2980B9D75206AD0D2B5722B7DEF6AFE6A48CE89A6E720032BA8670F642A423BA020B3EDF15246BEAD90452131D0969ACD30B45E24E8AA4F69189D73FC15037FBB98FD9483DF945CE5847C402EB15C6CF84D972E68793DD03F5E35F55DF718AA75D6893A2D943CB5DD8E2A0E917AF0E07EA8D8637F3EDAFB208D5170386;";
         String text = "85010C0398242843033D3BD70107FF62787C05BEF333EBD2E33D6DFE065D6A442B2CDF2ED949B69560DB170A365865F910396B95F6C84F7F5B66506587BB32EBB1FB12785BB5B8642C06E9B11BFEB64DFC687F202D8AFE60CC8CF7FDE33487BF78B561A0C00D482C7C50C3D902B98FD9EA9D337C8E27B05CABD93B6A8EC51DD216F6F46AD6D3566E1DC4CDF377779F787C77A1BDFB430C9A1A1B8E8E26D0BDE42B9B000DE24F6BCEB5F40C5D9D01B72FB5B219206544C81767FDD6B7E006BBFBE4FF70CC429637FFC2548180E1291A80FD7DADB7F94C185A6D70066E28533E4D188B7FED2E0B4EFE22B4B8BE8ED5769F7DDCE4728AE8845E5477ED45132CA124F2B593AED3E02727A75F9FD02A5232C9C02C608C10EF18AC2CAB425B324ECDD42D57B4037DBE9338ED43F128759FB44D44BCA9FA814871A8688BDC46C448D3A2AC3635D59FF622874ED204B1FF1E05B4360661ED67ED945D2425E1CD43B07E976AA0B1749890326C4B1A6B20DC731ADE153F308CFD0C4CE63B440E805DF9F57BCEC3F160B527109CC547278631B9651735670DD5210134C292C95584C258A55BF5D88EEEDB257C2675774A8D3ED999D93BD9916A44770656D3FE712E737019EF7935E3A174153F94DF4CD2D5D5AF347627F63F753799722447E0F01DEB2AF75B6468924C268EA0C82E244D1B754A4DD8D56AA3903D1476B652CBE5AC4EA3;";
       // decryptedRequest = ssmlib.decryptFile(text,"first_trust_dev_key23");
        decryptedRequest = ssmlib.decryptFile(text,"iksaqqqklmbsADFhasdf78$#");
       //  decryptedRequest = ssmlib.decryptFile(text,"H7DKIVdCu7Ai_kXiuBOsaNe7Jfft3-");
         System.out.println("Decrypted Request :  " + decryptedRequest);

     }

     public void stop(){
         System.out.println("Bye ....");
     }

     public void condition(String input){
         System.out.println("condition started ....");
         switch (input){
             case "A" : encryptRequest();break;
             case "B" : decryptRequest();break;
             case "C" : generateKeys();break;
             case "D" : stop();break;
         }
     }

     public void displayOperations(){
         System.out.println("Select one of the options \n " +
                 "Press  A to encryptRequest \n" +
                 "Press  B to decryptRequest  \n"+
                 "Press  C to generateKeys \n"+
                 "press  D to terminate program"
         );
     }



}

